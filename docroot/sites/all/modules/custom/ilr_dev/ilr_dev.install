<?php

/**
 * Implements hook_install()
 * Loops through the roles in the system and creates a test user for that role
 */

function ilr_dev_install() {
  require_once DRUPAL_ROOT . '/' . variable_get('password_inc', 'includes/password.inc');

  $users = array();
  $roles = user_roles(true);

  foreach ($roles as $name) {
    $rid = user_role_load_by_name($name)->rid;
    $users[] = array(
      'name' => $name,
      'pass' => user_hash_password('testing'),
      'mail' => "test_{$name}@cornell.edu",
      'status' => 1,
      'roles' => array($rid => true),
    );
  }

  foreach ($users as $user) {
    $new_user = user_save((object) $user);
  }
}
